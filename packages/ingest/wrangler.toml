name = "fastlaw-ingest"
compatibility_date = "2026-01-20"
main = "src/worker.ts"
compatibility_flags = ["nodejs_compat"]

[limits]
cpu_ms = 300000

[[d1_databases]]
binding = "DB"
database_name = "fastlaw"
database_id = "dc9efc6c-abb6-4790-9546-c3565022c186"
migrations_dir = "../../db/migrations"

[[r2_buckets]]
binding = "STORAGE"
bucket_name = "fastlaw-content"

[[workflows]]
name = "cga-ingest-workflow"
binding = "CGA_WORKFLOW"
class_name = "CGAIngestWorkflow"

[[workflows]]
name = "usc-ingest-workflow"
binding = "USC_WORKFLOW"
class_name = "USCIngestWorkflow"

[vars]
# Source URLs
CGA_BASE_URL = "https://www.cga.ct.gov"
CGA_START_PATH = "/current/pub/titles.htm"
USC_DOWNLOAD_BASE = "https://uscode.house.gov/download/releasepoints"

[observability]
enabled = true
head_sampling_rate = 1

[observability.logs]
enabled = true
head_sampling_rate = 1
persist = true
invocation_logs = true

[observability.traces]
enabled = true
head_sampling_rate = 1
